
# src/config.py
"""
Configuration settings for the Vedic Knowledge AI system.
Loads environment variables and provides configuration for different components.
"""
import os
import warnings # Import warnings
from dotenv import load_dotenv

# Load environment variables from .env file
load_dotenv()

# Directory paths
BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
DATA_DIR = os.getenv("DATA_DIR", os.path.join(BASE_DIR, "data")) # Consolidated data parent dir
PDF_DIR = os.getenv("PDF_DIR", os.path.join(DATA_DIR, "books"))
DB_DIR = os.getenv("DB_DIR", os.path.join(DATA_DIR, "db_new")) # Vector DB persistence
TEMP_DIR = os.getenv("TEMP_DIR", os.path.join(DATA_DIR, "temp"))

# Export directories
EXPORT_DIR = os.getenv("EXPORT_DIR", os.path.join(DATA_DIR, "exports"))
QA_LOGS_DIR = os.path.join(EXPORT_DIR, "qa_logs")
REPORTS_DIR = os.path.join(EXPORT_DIR, "reports")
SUMMARIES_DIR = os.path.join(EXPORT_DIR, "summaries")

# Web cache directory
WEB_CACHE_DIR = os.getenv("WEB_CACHE_DIR", os.path.join(DATA_DIR, "web_cache"))
# Default: 7 days in seconds
CACHE_EXPIRY = int(os.getenv("CACHE_EXPIRY", "604800"))

# Ensure base data directory and subdirectories exist
os.makedirs(DATA_DIR, exist_ok=True)
os.makedirs(PDF_DIR, exist_ok=True)
os.makedirs(DB_DIR, exist_ok=True)
os.makedirs(TEMP_DIR, exist_ok=True)
os.makedirs(EXPORT_DIR, exist_ok=True)
os.makedirs(QA_LOGS_DIR, exist_ok=True)
os.makedirs(REPORTS_DIR, exist_ok=True)
os.makedirs(SUMMARIES_DIR, exist_ok=True)
os.makedirs(WEB_CACHE_DIR, exist_ok=True)

# LLM Configuration
# Example: "gemini-1.5-flash", "gemini-1.5-pro" - Ensure the model is available for your API key
MODEL_NAME = "gemini-2.0-flash-001"
TEMPERATURE = float(os.getenv("TEMPERATURE", "0.2"))
MAX_TOKENS = int(os.getenv("MAX_TOKENS", "2048"))

# --- API Keys ---

GEMINI_API_KEY = 'AIzaSyDuLhEqJMWWtTseYm7V5KouXJ-605afKxY'

# --- Vector Database Configuration ---
CHUNK_SIZE = int(os.getenv("CHUNK_SIZE", "1000"))
CHUNK_OVERLAP = int(os.getenv("CHUNK_OVERLAP", "200"))
TOP_K_RESULTS = int(os.getenv("TOP_K_RESULTS", "5"))

# --- Embedding Model ---
# IMPORTANT: This model determines the vector dimensionality.
# If you change this after creating a vector database, you MUST delete
# the old database directory (DB_DIR) and re-ingest your data.
# 'sentence-transformers/all-mpnet-base-v2' has dimension 768.
# 'sentence-transformers/paraphrase-MiniLM-L6-v2' has dimension 384.
# Set your desired default here or via environment variable.
EMBEDDING_MODEL = os.getenv("EMBEDDING_MODEL", "sentence-transformers/all-mpnet-base-v2")

# --- Web Scraping Configuration ---
# Default to daily (24 hours in seconds)
SCRAPING_INTERVAL = 86400
# Default: 5 seconds between requests per domain
REQUEST_DELAY = 5

# Trusted websites for scraping (example list - load from env)
TRUSTED_WEBSITES_STR = os.getenv("TRUSTED_WEBSITES", "https://www.purebhakti.com,https://vedabase.io/en/,https://bhaktivedantavediclibrary.org/") # Example
TRUSTED_WEBSITES = [site.strip() for site in TRUSTED_WEBSITES_STR.split(',') if site.strip() and site.startswith(('http://', 'https://'))]


# --- Cloud Storage Configuration ---
# AWS
AWS_ACCESS_KEY_ID = os.getenv("AWS_ACCESS_KEY_ID")
AWS_SECRET_ACCESS_KEY = os.getenv("AWS_SECRET_ACCESS_KEY")
AWS_REGION = os.getenv("AWS_REGION", "us-east-1")
S3_BUCKET = os.getenv("S3_BUCKET")

# GCP
GCP_PROJECT_ID = os.getenv("GCP_PROJECT_ID")
GCP_BUCKET_NAME = os.getenv("GCP_BUCKET_NAME")

# Azure
AZURE_STORAGE_CONNECTION_STRING = os.getenv("AZURE_STORAGE_CONNECTION_STRING")
AZURE_CONTAINER_NAME = os.getenv("AZURE_CONTAINER_NAME")

# --- Logging Configuration ---
LOG_LEVEL = os.getenv("LOG_LEVEL", "INFO").upper() # Ensure uppercase
LOG_FILE = os.getenv("LOG_FILE", os.path.join(DATA_DIR, "vedic_knowledge_ai.log")) # Log within data dir